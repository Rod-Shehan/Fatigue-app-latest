(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[242],{115:function(e,t,a){Promise.resolve().then(a.bind(a,6520))},6520:function(e,t,a){"use strict";a.d(t,{default:function(){return g}});var s=a(7437),r=a(2265),l=a(1713),n=a(1884),i=a(1597),c=a(3459),o=a(7928),d=a(8954),h=a(2306),x=a(572),u=a(8678),p=a(8012),m=a(5366),f=a(9674);let y={work:{label:"Work",icon:d.Z},break:{label:"Break",icon:h.Z},rest:{label:"Rest",icon:x.Z},stop:{label:"End Shift",icon:u.Z}},b=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"];function k(e){let{days:t,weekStarting:a}=e,[,l]=(0,r.useState)(0);(0,r.useEffect)(()=>{let e=setInterval(()=>l(e=>e+1),1e4);return()=>clearInterval(e)},[]);let n=(0,f._P)(),i=[];t.forEach((e,t)=>{var s,r;let l=a?(0,f.uQ)(a,t):"",c=e.events||[],o=c[c.length-1],d=o&&"stop"!==o.type?o.type:null,h=o&&d?Math.floor((r=o.time,Math.floor((Date.now()-new Date(r).getTime())/1e3)/60)):0,x=l===n,u=null!==(s=b[t])&&void 0!==s?s:"D".concat(t+1),p=l?new Date(l+"T12:00:00").toLocaleDateString("en-AU",{day:"numeric",month:"short"}):"";c.forEach((e,a)=>{var s;let r=c[a+1],l=r?(s=e.time,Math.floor((new Date(r.time).getTime()-new Date(s).getTime())/6e4)):"stop"!==e.type&&x?h:0,n=e.type in y?e.type:"stop",o=!r&&!!d&&x;i.push({dayIndex:t,dayLabel:u,dateLabel:p,time:o?"now":new Date(e.time).toLocaleTimeString("en-AU",{hour:"2-digit",minute:"2-digit",hour12:!1}),type:n,duration:"stop"!==e.type?l:0,isOngoing:o,hasLocation:"lat"in e&&null!=e.lat&&"lng"in e&&null!=e.lng,shortBreak:"break"===e.type&&!!r&&l>0&&l<10})})});let c=i.length>0;return(0,s.jsx)("div",{className:"bg-white dark:bg-slate-900 rounded-xl border border-slate-200 dark:border-slate-700 shadow-sm overflow-hidden",children:(0,s.jsx)("div",{className:"overflow-x-auto",children:(0,s.jsxs)("table",{className:"w-full text-xs border-collapse",children:[(0,s.jsx)("thead",{children:(0,s.jsxs)("tr",{className:"bg-slate-50 dark:bg-slate-800 border-b border-slate-200 dark:border-slate-600",children:[(0,s.jsx)("th",{className:"text-left py-2 px-2 font-semibold text-slate-500 dark:text-slate-400 uppercase tracking-wider w-10",children:"Day"}),(0,s.jsx)("th",{className:"text-left py-2 px-2 font-semibold text-slate-500 dark:text-slate-400 uppercase tracking-wider w-16",children:"Date"}),(0,s.jsx)("th",{className:"text-left py-2 px-2 font-semibold text-slate-500 dark:text-slate-400 uppercase tracking-wider w-14",children:"Time"}),(0,s.jsx)("th",{className:"text-left py-2 px-2 font-semibold text-slate-500 dark:text-slate-400 uppercase tracking-wider",children:"Type"}),(0,s.jsx)("th",{className:"text-right py-2 px-2 font-semibold text-slate-500 dark:text-slate-400 uppercase tracking-wider w-14",children:"Duration"}),(0,s.jsx)("th",{className:"w-8 py-2 px-1","aria-label":"Location"})]})}),(0,s.jsx)("tbody",{children:c?i.map((e,t)=>{var a,l,n;let i=y[e.type],c=m.N[e.type].badge;return(0,s.jsxs)("tr",{className:"border-b border-slate-100 dark:border-slate-700 last:border-0 ".concat(e.isOngoing?"bg-slate-50/70 dark:bg-slate-800/70":""),children:[(0,s.jsx)("td",{className:"py-1.5 px-2 font-medium text-slate-600 dark:text-slate-300",children:e.dayLabel}),(0,s.jsx)("td",{className:"py-1.5 px-2 text-slate-500 dark:text-slate-400 font-mono",children:e.dateLabel}),(0,s.jsx)("td",{className:"py-1.5 px-2 font-mono text-slate-600 dark:text-slate-300",children:e.time}),(0,s.jsxs)("td",{className:"py-1.5 px-2",children:[(0,s.jsxs)("span",{className:"inline-flex items-center gap-1 px-1.5 py-0.5 rounded text-[10px] font-semibold ".concat(c),children:[r.createElement(null!==(a=null==i?void 0:i.icon)&&void 0!==a?a:u.Z,{className:"w-2.5 h-2.5"}),null!==(l=null==i?void 0:i.label)&&void 0!==l?l:e.type]}),e.shortBreak&&(0,s.jsx)("span",{className:"ml-1 text-amber-500",children:"⚠ <10m"})]}),(0,s.jsx)("td",{className:"py-1.5 px-2 text-right font-mono text-slate-500 dark:text-slate-400",children:e.duration>0?(n=e.duration)<60?"".concat(n,"m"):"".concat(Math.floor(n/60),"h ").concat(n%60,"m"):"—"}),(0,s.jsx)("td",{className:"py-1.5 px-1 text-center",children:e.hasLocation?(0,s.jsx)("span",{className:"inline-flex",title:"Location recorded",children:(0,s.jsx)(p.Z,{className:"w-3 h-3 text-slate-400 inline","aria-hidden":!0})}):null})]},t)}):(0,s.jsx)("tr",{children:(0,s.jsx)("td",{colSpan:6,className:"py-6 px-4 text-center text-slate-400 italic",children:"No events recorded"})})})]})})})}function g(e){var t,a;let{sheetId:d}=e;(0,r.useEffect)(()=>{if(d)try{sessionStorage.setItem("fatigue-last-sheet-id",d)}catch(e){}},[d]);let{data:h,isLoading:x}=(0,l.a)({queryKey:["sheet",d],queryFn:()=>(0,n.r9)(d)});if(x||!h)return(0,s.jsx)("div",{className:"flex items-center justify-center min-h-screen bg-slate-50 dark:bg-slate-950",children:(0,s.jsx)(c.Z,{className:"w-6 h-6 animate-spin text-slate-400 dark:text-slate-500"})});let u=null!==(t=h.days)&&void 0!==t?t:[],p=null!==(a=h.week_starting)&&void 0!==a?a:"",m=[h.driver_name,p&&"Week starting ".concat(new Date(p+"T12:00:00").toLocaleDateString("en-AU",{day:"numeric",month:"short",year:"numeric"}))].filter(Boolean).join(" \xb7 ");return(0,s.jsx)("div",{className:"min-h-screen bg-slate-50 dark:bg-slate-950 pb-6",children:(0,s.jsxs)("div",{className:"max-w-[800px] mx-auto px-4 py-6",children:[(0,s.jsx)(i.m,{backHref:"/sheets/".concat(d),backLabel:"Fatigue Record",title:"Shift Log",subtitle:m||void 0,icon:(0,s.jsx)(o.Z,{className:"w-5 h-5"})}),(0,s.jsx)(k,{days:u,weekStarting:p})]})})}},8954:function(e,t,a){"use strict";a.d(t,{Z:function(){return s}});let s=(0,a(6471).Z)("Briefcase",[["path",{d:"M16 20V4a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"jecpp"}],["rect",{width:"20",height:"14",x:"2",y:"6",rx:"2",key:"i6l2r4"}]])},2306:function(e,t,a){"use strict";a.d(t,{Z:function(){return s}});let s=(0,a(6471).Z)("Coffee",[["path",{d:"M10 2v2",key:"7u0qdc"}],["path",{d:"M14 2v2",key:"6buw04"}],["path",{d:"M16 8a1 1 0 0 1 1 1v8a4 4 0 0 1-4 4H7a4 4 0 0 1-4-4V9a1 1 0 0 1 1-1h14a4 4 0 1 1 0 8h-1",key:"pwadti"}],["path",{d:"M6 2v2",key:"colzsn"}]])},7928:function(e,t,a){"use strict";a.d(t,{Z:function(){return s}});let s=(0,a(6471).Z)("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]])},8012:function(e,t,a){"use strict";a.d(t,{Z:function(){return s}});let s=(0,a(6471).Z)("MapPin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]])},572:function(e,t,a){"use strict";a.d(t,{Z:function(){return s}});let s=(0,a(6471).Z)("Moon",[["path",{d:"M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z",key:"a7tn18"}]])},8678:function(e,t,a){"use strict";a.d(t,{Z:function(){return s}});let s=(0,a(6471).Z)("Square",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]])}},function(e){e.O(0,[21,648,91,586,971,117,744],function(){return e(e.s=115)}),_N_E=e.O()}]);