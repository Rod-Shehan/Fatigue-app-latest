(()=>{var e={};e.id=242,e.ids=[242],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},27790:e=>{"use strict";e.exports=require("assert")},78893:e=>{"use strict";e.exports=require("buffer")},84770:e=>{"use strict";e.exports=require("crypto")},17702:e=>{"use strict";e.exports=require("events")},32615:e=>{"use strict";e.exports=require("http")},35240:e=>{"use strict";e.exports=require("https")},86624:e=>{"use strict";e.exports=require("querystring")},17360:e=>{"use strict";e.exports=require("url")},21764:e=>{"use strict";e.exports=require("util")},71568:e=>{"use strict";e.exports=require("zlib")},98777:(e,t,a)=>{"use strict";a.r(t),a.d(t,{GlobalError:()=>i.a,__next_app__:()=>x,originalPathname:()=>u,pages:()=>c,routeModule:()=>m,tree:()=>o}),a(2206),a(13647),a(35866);var r=a(23191),s=a(88716),l=a(37922),i=a.n(l),n=a(95231),d={};for(let e in n)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(d[e]=()=>n[e]);a.d(t,d);let o=["",{children:["sheets",{children:["[id]",{children:["shift-log",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(a.bind(a,2206)),"C:\\Users\\r_she\\Documents\\Fatigue app\\app-next\\src\\app\\sheets\\[id]\\shift-log\\page.tsx"]}]},{}]},{}]},{}]},{layout:[()=>Promise.resolve().then(a.bind(a,13647)),"C:\\Users\\r_she\\Documents\\Fatigue app\\app-next\\src\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(a.t.bind(a,35866,23)),"next/dist/client/components/not-found-error"]}],c=["C:\\Users\\r_she\\Documents\\Fatigue app\\app-next\\src\\app\\sheets\\[id]\\shift-log\\page.tsx"],u="/sheets/[id]/shift-log/page",x={require:a,loadChunk:()=>Promise.resolve()},m=new r.AppPageRouteModule({definition:{kind:s.x.APP_PAGE,page:"/sheets/[id]/shift-log/page",pathname:"/sheets/[id]/shift-log",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:o}})},53871:(e,t,a)=>{Promise.resolve().then(a.bind(a,75825))},75825:(e,t,a)=>{"use strict";a.d(t,{default:()=>y});var r=a(10326),s=a(17577),l=a.n(s),i=a(20108),n=a(18775),d=a(82066),o=a(46721),c=a(43022),u=a(24635),x=a(40666),m=a(55947),h=a(63144),p=a(65249),b=a(46015),g=a(29668);let f={work:{label:"Work",icon:u.Z},break:{label:"Break",icon:x.Z},rest:{label:"Rest",icon:m.Z},stop:{label:"End Shift",icon:h.Z}},k=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"];function w({days:e,weekStarting:t}){let[,a]=(0,s.useState)(0),i=(0,g._P)(),n=[];e.forEach((e,a)=>{var r;let s=t?(0,g.uQ)(t,a):"",l=e.events||[],d=l[l.length-1],o=d&&"stop"!==d.type?d.type:null,c=d&&o?Math.floor((r=d.time,Math.floor((Date.now()-new Date(r).getTime())/1e3)/60)):0,u=s===i,x=k[a]??`D${a+1}`,m=s?new Date(s+"T12:00:00").toLocaleDateString("en-AU",{day:"numeric",month:"short"}):"";l.forEach((e,t)=>{var r;let s=l[t+1],i=s?(r=e.time,Math.floor((new Date(s.time).getTime()-new Date(r).getTime())/6e4)):"stop"!==e.type&&u?c:0,d=e.type in f?e.type:"stop",h=!s&&!!o&&u;n.push({dayIndex:a,dayLabel:x,dateLabel:m,time:h?"now":new Date(e.time).toLocaleTimeString("en-AU",{hour:"2-digit",minute:"2-digit",hour12:!1}),type:d,duration:"stop"!==e.type?i:0,isOngoing:h,hasLocation:"lat"in e&&null!=e.lat&&"lng"in e&&null!=e.lng,shortBreak:"break"===e.type&&!!s&&i>0&&i<10})})});let d=n.length>0;return r.jsx("div",{className:"bg-white dark:bg-slate-900 rounded-xl border border-slate-200 dark:border-slate-700 shadow-sm overflow-hidden",children:r.jsx("div",{className:"overflow-x-auto",children:(0,r.jsxs)("table",{className:"w-full text-xs border-collapse",children:[r.jsx("thead",{children:(0,r.jsxs)("tr",{className:"bg-slate-50 dark:bg-slate-800 border-b border-slate-200 dark:border-slate-600",children:[r.jsx("th",{className:"text-left py-2 px-2 font-semibold text-slate-500 dark:text-slate-400 uppercase tracking-wider w-10",children:"Day"}),r.jsx("th",{className:"text-left py-2 px-2 font-semibold text-slate-500 dark:text-slate-400 uppercase tracking-wider w-16",children:"Date"}),r.jsx("th",{className:"text-left py-2 px-2 font-semibold text-slate-500 dark:text-slate-400 uppercase tracking-wider w-14",children:"Time"}),r.jsx("th",{className:"text-left py-2 px-2 font-semibold text-slate-500 dark:text-slate-400 uppercase tracking-wider",children:"Type"}),r.jsx("th",{className:"text-right py-2 px-2 font-semibold text-slate-500 dark:text-slate-400 uppercase tracking-wider w-14",children:"Duration"}),r.jsx("th",{className:"w-8 py-2 px-1","aria-label":"Location"})]})}),r.jsx("tbody",{children:d?n.map((e,t)=>{var a;let s=f[e.type],i=b.N[e.type].badge;return(0,r.jsxs)("tr",{className:`border-b border-slate-100 dark:border-slate-700 last:border-0 ${e.isOngoing?"bg-slate-50/70 dark:bg-slate-800/70":""}`,children:[r.jsx("td",{className:"py-1.5 px-2 font-medium text-slate-600 dark:text-slate-300",children:e.dayLabel}),r.jsx("td",{className:"py-1.5 px-2 text-slate-500 dark:text-slate-400 font-mono",children:e.dateLabel}),r.jsx("td",{className:"py-1.5 px-2 font-mono text-slate-600 dark:text-slate-300",children:e.time}),(0,r.jsxs)("td",{className:"py-1.5 px-2",children:[(0,r.jsxs)("span",{className:`inline-flex items-center gap-1 px-1.5 py-0.5 rounded text-[10px] font-semibold ${i}`,children:[l().createElement(s?.icon??h.Z,{className:"w-2.5 h-2.5"}),s?.label??e.type]}),e.shortBreak&&r.jsx("span",{className:"ml-1 text-amber-500",children:"⚠ <10m"})]}),r.jsx("td",{className:"py-1.5 px-2 text-right font-mono text-slate-500 dark:text-slate-400",children:e.duration>0?(a=e.duration)<60?`${a}m`:`${Math.floor(a/60)}h ${a%60}m`:"—"}),r.jsx("td",{className:"py-1.5 px-1 text-center",children:e.hasLocation?r.jsx("span",{className:"inline-flex",title:"Location recorded",children:r.jsx(p.Z,{className:"w-3 h-3 text-slate-400 inline","aria-hidden":!0})}):null})]},t)}):r.jsx("tr",{children:r.jsx("td",{colSpan:6,className:"py-6 px-4 text-center text-slate-400 italic",children:"No events recorded"})})})]})})})}function y({sheetId:e}){let{data:t,isLoading:a}=(0,i.a)({queryKey:["sheet",e],queryFn:()=>(0,n.r9)(e)});if(a||!t)return r.jsx("div",{className:"flex items-center justify-center min-h-screen bg-slate-50 dark:bg-slate-950",children:r.jsx(o.Z,{className:"w-6 h-6 animate-spin text-slate-400 dark:text-slate-500"})});let s=t.days??[],l=t.week_starting??"",u=[t.driver_name,l&&`Week starting ${new Date(l+"T12:00:00").toLocaleDateString("en-AU",{day:"numeric",month:"short",year:"numeric"})}`].filter(Boolean).join(" \xb7 ");return r.jsx("div",{className:"min-h-screen bg-slate-50 dark:bg-slate-950 pb-6",children:(0,r.jsxs)("div",{className:"max-w-[800px] mx-auto px-4 py-6",children:[r.jsx(d.m,{backHref:`/sheets/${e}`,backLabel:"Fatigue Record",title:"Shift Log",subtitle:u||void 0,icon:r.jsx(c.Z,{className:"w-5 h-5"})}),r.jsx(w,{days:s,weekStarting:l})]})})}},82066:(e,t,a)=>{"use strict";a.d(t,{m:()=>i});var r=a(10326);a(17577);var s=a(90434),l=a(9921);function i({backHref:e,backLabel:t="Your Sheets",title:a,subtitle:i,icon:n,actions:d}){return(0,r.jsxs)("header",{className:"flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between sm:flex-wrap mb-6",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3 min-w-0 flex-shrink-0",children:[null!=e?r.jsx(s.default,{href:e,className:"flex shrink-0 rounded-full text-slate-600 dark:text-slate-400 hover:text-slate-900 dark:hover:text-slate-100 hover:bg-slate-100 dark:hover:bg-slate-800 transition-colors focus:outline-none focus:ring-2 focus:ring-slate-400 focus:ring-offset-2 dark:focus:ring-offset-slate-900","aria-label":t,title:t,children:r.jsx("span",{className:"flex items-center justify-center min-w-10 min-h-10 w-10 h-10 sm:min-w-12 sm:min-h-12 sm:w-12 sm:h-12",children:r.jsx(l.Z,{className:"w-5 h-5 sm:w-6 sm:h-6",strokeWidth:2.25})})}):r.jsx("span",{className:"w-10 h-10 sm:w-12 sm:h-12 shrink-0","aria-hidden":!0}),(0,r.jsxs)("div",{className:"flex items-center gap-3 min-w-0 flex-1",children:[null!=n&&r.jsx("div",{className:"w-9 h-9 sm:w-10 sm:h-10 rounded-xl bg-slate-900 dark:bg-slate-600 flex items-center justify-center text-white dark:text-slate-200 shrink-0",children:n}),(0,r.jsxs)("div",{className:"min-w-0 flex-1",children:[r.jsx("h1",{className:"text-base sm:text-lg md:text-xl font-bold text-slate-800 dark:text-slate-100 truncate",children:a}),null!=i&&r.jsx("p",{className:"text-xs text-slate-400 dark:text-slate-500 truncate mt-0.5",children:i})]})]})]}),null!=d&&r.jsx("div",{className:"flex flex-wrap items-center gap-2 justify-start min-w-0 w-full sm:w-auto",children:d})]})}},46015:(e,t,a)=>{"use strict";a.d(t,{N:()=>r,t:()=>s});let r={work:{hex:"#3b82f6",rgb:[59,130,246],button:"bg-blue-500 hover:bg-blue-600 disabled:bg-blue-300",badge:"bg-blue-100 text-blue-700 dark:bg-blue-900/50 dark:text-blue-200",statsCard:"bg-blue-50 dark:bg-blue-900/30 dark:border-blue-800/50",statsLabel:"text-blue-500 dark:text-blue-400",statsValue:"text-blue-700 dark:text-blue-200"},break:{hex:"#f59e0b",rgb:[251,191,36],button:"bg-amber-500 hover:bg-amber-600 disabled:bg-amber-300",badge:"bg-amber-100 text-amber-700 dark:bg-amber-900/50 dark:text-amber-200",statsCard:"bg-amber-50 dark:bg-amber-900/30 dark:border-amber-800/50",statsLabel:"text-amber-500 dark:text-amber-400",statsValue:"text-amber-700 dark:text-amber-200"},rest:{hex:"#10b981",rgb:[52,211,153],button:"bg-emerald-500 hover:bg-emerald-600 disabled:bg-emerald-300",badge:"bg-emerald-100 text-emerald-700 dark:bg-emerald-900/50 dark:text-emerald-200",statsCard:"bg-emerald-50 dark:bg-emerald-900/30 dark:border-emerald-800/50",statsLabel:"text-emerald-500 dark:text-emerald-400",statsValue:"text-emerald-700 dark:text-emerald-200"},stop:{hex:"#ef4444",rgb:[239,68,68],button:"bg-red-500 hover:bg-red-600 disabled:bg-red-300",badge:"bg-red-100 text-red-700 dark:bg-red-900/50 dark:text-red-200",statsCard:"bg-red-50 dark:bg-red-900/30 dark:border-red-800/50",statsLabel:"text-red-500 dark:text-red-400",statsValue:"text-red-700 dark:text-red-200"}},s=[{key:"work_time",label:"Work",color:r.work.hex},{key:"breaks",label:"Breaks",color:r.break.hex},{key:"non_work",label:"Non-Work Time",color:r.rest.hex}]},29668:(e,t,a)=>{"use strict";function r(e){let t=e.getFullYear(),a=String(e.getMonth()+1).padStart(2,"0"),r=String(e.getDate()).padStart(2,"0");return`${t}-${a}-${r}`}function s(){return r(new Date)}function l(e,t){let[a,s,l]=e.split("-").map(Number),i=new Date(a,s-1,l);return i.setDate(i.getDate()+t),r(i)}a.d(t,{_P:()=>s,uQ:()=>l})},2206:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>d});var r=a(19510),s=a(58585),l=a(75571),i=a(95456);let n=(0,a(68570).createProxy)(String.raw`C:\Users\r_she\Documents\Fatigue app\app-next\src\app\sheets\[id]\shift-log\shift-log-page.tsx#default`);async function d({params:e}){await (0,l.getServerSession)(i.Lz)||(0,s.redirect)("/login");let{id:t}=await e;return r.jsx(n,{sheetId:t})}},95456:(e,t,a)=>{"use strict";a.d(t,{Ad:()=>o,Lz:()=>n,SC:()=>c,gS:()=>d});var r=a(75571),s=a(13539),l=a(53797),i=a(20728);let n={adapter:(0,s.N)(i._),session:{strategy:"jwt",maxAge:2592e3},pages:{signIn:"/login"},providers:[(0,l.Z)({name:"Email and password",credentials:{email:{label:"Email",type:"email"},password:{label:"Password",type:"password"}},async authorize(e){let t=e?.email,a=e?.password;if(!t||!a)return null;let r=void 0;if(r&&a===r){let e=await i._.user.findUnique({where:{email:t}});return e||(e=await i._.user.create({data:{email:t,name:t.split("@")[0]}})),{id:e.id,email:e.email,name:e.name}}return null}})],callbacks:{jwt:async({token:e,user:t})=>(t&&(e.id=t.id,e.email=t.email),e),session:async({session:e,token:t})=>(e.user&&(e.user.id=t.id),e)}};async function d(){let e=await (0,r.getServerSession)(n),t=e?.user&&"id"in e.user?e.user.id:void 0;return t?{session:e,userId:t,isManager:!!await c()}:null}function o(e,t){return!!t.isManager||e.createdById===t.userId}async function c(){let e=await (0,r.getServerSession)(n),t=e?.user?e.user.id:void 0;if(!t)return null;let a=await i._.user.findUnique({where:{id:t},select:{id:!0,email:!0,name:!0,role:!0}});return a?"manager"!==a.role&&await i._.user.findFirst({where:{role:"manager"},select:{id:!0}})?null:{session:e,user:a}:null}},20728:(e,t,a)=>{"use strict";a.d(t,{_:()=>s});let r=require("@prisma/client"),s=globalThis.prisma??new r.PrismaClient({log:["error"]})},24635:(e,t,a)=>{"use strict";a.d(t,{Z:()=>r});let r=(0,a(9664).Z)("Briefcase",[["path",{d:"M16 20V4a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"jecpp"}],["rect",{width:"20",height:"14",x:"2",y:"6",rx:"2",key:"i6l2r4"}]])},40666:(e,t,a)=>{"use strict";a.d(t,{Z:()=>r});let r=(0,a(9664).Z)("Coffee",[["path",{d:"M10 2v2",key:"7u0qdc"}],["path",{d:"M14 2v2",key:"6buw04"}],["path",{d:"M16 8a1 1 0 0 1 1 1v8a4 4 0 0 1-4 4H7a4 4 0 0 1-4-4V9a1 1 0 0 1 1-1h14a4 4 0 1 1 0 8h-1",key:"pwadti"}],["path",{d:"M6 2v2",key:"colzsn"}]])},43022:(e,t,a)=>{"use strict";a.d(t,{Z:()=>r});let r=(0,a(9664).Z)("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]])},65249:(e,t,a)=>{"use strict";a.d(t,{Z:()=>r});let r=(0,a(9664).Z)("MapPin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]])},63144:(e,t,a)=>{"use strict";a.d(t,{Z:()=>r});let r=(0,a(9664).Z)("Square",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]])}};var t=require("../../../../webpack-runtime.js");t.C(e);var a=e=>t(t.s=e),r=t.X(0,[276,637,492,833,894,562],()=>a(98777));module.exports=r})();