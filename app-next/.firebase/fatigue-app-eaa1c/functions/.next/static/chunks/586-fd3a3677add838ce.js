"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[586],{1597:function(e,t,r){r.d(t,{m:function(){return o}});var a=r(7437);r(2265);var n=r(7648),s=r(5485);function o(e){let{backHref:t,backLabel:r="Your Sheets",title:o,subtitle:i,icon:l,actions:c}=e;return(0,a.jsxs)("header",{className:"flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between sm:flex-wrap mb-6",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3 min-w-0 flex-shrink-0",children:[null!=t?(0,a.jsx)(n.default,{href:t,className:"flex shrink-0 rounded-full text-slate-600 dark:text-slate-400 hover:text-slate-900 dark:hover:text-slate-100 hover:bg-slate-100 dark:hover:bg-slate-800 transition-colors focus:outline-none focus:ring-2 focus:ring-slate-400 focus:ring-offset-2 dark:focus:ring-offset-slate-900","aria-label":r,title:r,children:(0,a.jsx)("span",{className:"flex items-center justify-center min-w-10 min-h-10 w-10 h-10 sm:min-w-12 sm:min-h-12 sm:w-12 sm:h-12",children:(0,a.jsx)(s.Z,{className:"w-5 h-5 sm:w-6 sm:h-6",strokeWidth:2.25})})}):(0,a.jsx)("span",{className:"w-10 h-10 sm:w-12 sm:h-12 shrink-0","aria-hidden":!0}),(0,a.jsxs)("div",{className:"flex items-center gap-3 min-w-0 flex-1",children:[null!=l&&(0,a.jsx)("div",{className:"w-9 h-9 sm:w-10 sm:h-10 rounded-xl bg-slate-900 dark:bg-slate-600 flex items-center justify-center text-white dark:text-slate-200 shrink-0",children:l}),(0,a.jsxs)("div",{className:"min-w-0 flex-1",children:[(0,a.jsx)("h1",{className:"text-base sm:text-lg md:text-xl font-bold text-slate-800 dark:text-slate-100 truncate",children:o}),null!=i&&(0,a.jsx)("p",{className:"text-xs text-slate-400 dark:text-slate-500 truncate mt-0.5",children:i})]})]})]}),null!=c&&(0,a.jsx)("div",{className:"flex flex-wrap items-center gap-2 justify-start min-w-0 w-full sm:w-auto",children:c})]})}},1837:function(e,t,r){async function a(e,t){let{method:r="GET",body:a,...n}=null!=t?t:{},s={...n,method:r,headers:{"Content-Type":"application/json",...n.headers},credentials:"include",...void 0!==a&&{body:JSON.stringify(a)}},o=await fetch("".concat("").concat(e),s);if(!o.ok){var i;let e=await o.json().catch(()=>({error:o.statusText})),t=Error(null!==(i=e.error)&&void 0!==i?i:"Request failed");throw t.body=e,t}if(204!==o.status)return o.json()}r.d(t,{h:function(){return n}});let n={compliance:{check:e=>a("/api/compliance/check",{method:"POST",body:e})},regos:{list:()=>a("/api/regos"),create:e=>a("/api/regos",{method:"POST",body:e}),update:(e,t)=>a("/api/regos/".concat(e),{method:"PATCH",body:t}),delete:e=>a("/api/regos/".concat(e),{method:"DELETE"})},drivers:{list:()=>a("/api/drivers"),create:e=>a("/api/drivers",{method:"POST",body:e}),update:(e,t)=>a("/api/drivers/".concat(e),{method:"PATCH",body:t}),delete:e=>a("/api/drivers/".concat(e),{method:"DELETE"})},sheets:{list:()=>a("/api/sheets"),get:e=>a("/api/sheets/".concat(e)),regoMaxEndKms:e=>a("/api/rego-kms?rego=".concat(encodeURIComponent(e))),create:e=>a("/api/sheets",{method:"POST",body:e}),update:(e,t)=>a("/api/sheets/".concat(e),{method:"PATCH",body:t}),delete:e=>a("/api/sheets/".concat(e),{method:"DELETE"}),exportPdfUrl:e=>"".concat("","/api/sheets/").concat(e,"/export")},users:{create:e=>a("/api/users",{method:"POST",body:e})}}},1884:function(e,t,r){r.d(t,{nL:function(){return S},eI:function(){return _},r9:function(){return v},Gg:function(){return p},OX:function(){return N},Fy:function(){return j},Wn:function(){return y},o_:function(){return P}});var a=r(1837);let n="sheets",s="sheetsList",o="regos",i="pending";function l(){return new Promise((e,t)=>{let r=indexedDB.open("fatigue-offline",1);r.onerror=()=>t(r.error),r.onsuccess=()=>e(r.result),r.onupgradeneeded=e=>{let t=e.target.result;t.objectStoreNames.contains(n)||t.createObjectStore(n,{keyPath:"id"}),t.objectStoreNames.contains(s)||t.createObjectStore(s,{keyPath:"key"}),t.objectStoreNames.contains(o)||t.createObjectStore(o,{keyPath:"key"}),t.objectStoreNames.contains(i)||t.createObjectStore(i,{keyPath:"id",autoIncrement:!0})}})}function c(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"readonly";return e.transaction(t,r).objectStore(t)}async function d(e){let t=await l();return new Promise((r,a)=>{let s=c(t,n).get(e);s.onsuccess=()=>{var e;return r(null!==(e=s.result)&&void 0!==e?e:null)},s.onerror=()=>a(s.error)})}async function u(e){let t=await l();return new Promise((r,a)=>{let s=c(t,n,"readwrite").put(e);s.onsuccess=()=>r(),s.onerror=()=>a(s.error)})}async function b(e){let t=await l();return new Promise((r,a)=>{let s=c(t,n,"readwrite").delete(e);s.onsuccess=()=>r(),s.onerror=()=>a(s.error)})}async function m(){let e=await l();return new Promise((t,r)=>{let a=c(e,s).get("list");a.onsuccess=()=>{var e,r;return t(null!==(r=null===(e=a.result)||void 0===e?void 0:e.value)&&void 0!==r?r:[])},a.onerror=()=>r(a.error)})}async function h(e){let t=await l();return new Promise((r,a)=>{let n=c(t,s,"readwrite").put({key:"list",value:e});n.onsuccess=()=>r(),n.onerror=()=>a(n.error)})}async function f(){let e=await l();return new Promise((t,r)=>{let a=c(e,o).get("regos");a.onsuccess=()=>{var e,r;return t(null!==(r=null===(e=a.result)||void 0===e?void 0:e.value)&&void 0!==r?r:[])},a.onerror=()=>r(a.error)})}async function w(e){let t=await l();return new Promise((r,a)=>{let n=c(t,o,"readwrite").put({key:"regos",value:e});n.onsuccess=()=>r(),n.onerror=()=>a(n.error)})}async function g(){let e=await l();return new Promise((t,r)=>{let a=c(e,i).getAll();a.onsuccess=()=>{var e;return t(null!==(e=a.result)&&void 0!==e?e:[])},a.onerror=()=>r(a.error)})}async function x(e){let t=await l(),r={...e,at:Date.now()};return new Promise((e,a)=>{let n=c(t,i,"readwrite").add(r);n.onsuccess=()=>e(),n.onerror=()=>a(n.error)})}async function k(e){let t=await l();return new Promise((r,a)=>{let n=c(t,i,"readwrite").delete(e);n.onsuccess=()=>r(),n.onerror=()=>a(n.error)})}function p(){return"undefined"!=typeof navigator&&navigator.onLine}async function y(){let e;if(!p())return{synced:0};let t=await g(),r=0;for(let n of t){let t=n.id;if(null!=t)try{if("update"===n.type)await a.h.sheets.update(n.sheetId,n.data),await u(await a.h.sheets.get(n.sheetId)),await k(t),r++;else if("create"===n.type){let s=await d(n.tempId),o=s?{driver_name:s.driver_name,second_driver:s.second_driver,driver_type:s.driver_type,destination:s.destination,last_24h_break:s.last_24h_break,week_starting:s.week_starting,days:s.days,status:s.status,signature:s.signature,signed_at:s.signed_at}:n.data,i=await a.h.sheets.create(o);await u(i),await b(n.tempId);let l=(await m()).filter(e=>e.id!==n.tempId);l.push(i),await h(l),await k(t),e={tempId:n.tempId,realId:i.id},r++}}catch(t){return{synced:r,error:t instanceof Error?t.message:"Sync failed",replacedTempId:e}}}return{synced:r,replacedTempId:e}}async function v(e){if(e.startsWith("local-")){let t=await d(e);if(t)return t;throw Error("Local sheet not found.")}if(p())try{let t=await a.h.sheets.get(e);return await u(t),t}catch(r){let t=await d(e);if(t)return t;throw Error("Sheet not found and not available offline.")}let t=await d(e);if(t)return t;throw Error("You're offline and this sheet isn't cached. Connect to load it.")}async function j(){if(p())try{let e=await a.h.sheets.list();return await h(e),e}catch(e){}return m()}async function P(e,t){let r=await d(e).catch(()=>null),a=r?{...r,...t,id:e}:{...t,id:e};await u(a);let n=e.startsWith("local-");if(n||await x({type:"update",sheetId:e,data:t}),p()&&!n&&(await y()).synced>0){let t=await d(e);if(t)return t}return a}async function S(e){if(p()){let t=await a.h.sheets.create(e);await u(t);let r=await m();return await h([...r,t]),t}let t="local-".concat(Date.now(),"-").concat(Math.random().toString(36).slice(2,9)),r={...e,id:t};await u(r);let n=await m();return await h([...n,r]),await x({type:"create",tempId:t,data:e}),r}async function N(){if(p())try{let e=await a.h.regos.list();return await w(e),e}catch(e){}return f()}async function _(){return(await g()).length}},5366:function(e,t,r){r.d(t,{N:function(){return a},t:function(){return n}});let a={work:{hex:"#3b82f6",rgb:[59,130,246],button:"bg-blue-500 hover:bg-blue-600 disabled:bg-blue-300",badge:"bg-blue-100 text-blue-700 dark:bg-blue-900/50 dark:text-blue-200",statsCard:"bg-blue-50 dark:bg-blue-900/30 dark:border-blue-800/50",statsLabel:"text-blue-500 dark:text-blue-400",statsValue:"text-blue-700 dark:text-blue-200"},break:{hex:"#f59e0b",rgb:[251,191,36],button:"bg-amber-500 hover:bg-amber-600 disabled:bg-amber-300",badge:"bg-amber-100 text-amber-700 dark:bg-amber-900/50 dark:text-amber-200",statsCard:"bg-amber-50 dark:bg-amber-900/30 dark:border-amber-800/50",statsLabel:"text-amber-500 dark:text-amber-400",statsValue:"text-amber-700 dark:text-amber-200"},rest:{hex:"#10b981",rgb:[52,211,153],button:"bg-emerald-500 hover:bg-emerald-600 disabled:bg-emerald-300",badge:"bg-emerald-100 text-emerald-700 dark:bg-emerald-900/50 dark:text-emerald-200",statsCard:"bg-emerald-50 dark:bg-emerald-900/30 dark:border-emerald-800/50",statsLabel:"text-emerald-500 dark:text-emerald-400",statsValue:"text-emerald-700 dark:text-emerald-200"},stop:{hex:"#ef4444",rgb:[239,68,68],button:"bg-red-500 hover:bg-red-600 disabled:bg-red-300",badge:"bg-red-100 text-red-700 dark:bg-red-900/50 dark:text-red-200",statsCard:"bg-red-50 dark:bg-red-900/30 dark:border-red-800/50",statsLabel:"text-red-500 dark:text-red-400",statsValue:"text-red-700 dark:text-red-200"}},n=[{key:"work_time",label:"Work",color:a.work.hex},{key:"breaks",label:"Breaks",color:a.break.hex},{key:"non_work",label:"Non-Work Time",color:a.rest.hex}]},9674:function(e,t,r){function a(e){let t=e.getFullYear(),r=String(e.getMonth()+1).padStart(2,"0"),a=String(e.getDate()).padStart(2,"0");return"".concat(t,"-").concat(r,"-").concat(a)}function n(){return a(new Date)}function s(e,t){let[r,n,s]=e.split("-").map(Number),o=new Date(r,n-1,s);return o.setDate(o.getDate()+t),a(o)}r.d(t,{_P:function(){return n},uQ:function(){return s}})}}]);